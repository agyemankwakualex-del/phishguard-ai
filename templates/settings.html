{% extends "base.html" %}

{% block title %}Settings - PhishGuard AI{% endblock %}
{% block page_title %}Settings{% endblock %}

{% block content %}
<div class="settings-container">
    {% if message %}
    <div class="alert alert-success">âœ… {{ message }}</div>
    {% endif %}
    
    <!-- Gmail Connection -->
    <div class="card">
        <div class="card-header">
            <h3>ğŸ“§ Gmail Connection</h3>
        </div>
        <div class="card-body">
            {% if config.gmail_connected %}
            <div class="gmail-status connected">
                <div class="status-info">
                    <span class="status-icon">âœ…</span>
                    <div>
                        <strong>Connected</strong>
                        <p>{{ config.gmail_email }}</p>
                    </div>
                </div>
                <div class="gmail-actions">
                    <a href="{{ url_for('gmail_scan') }}" class="action-button primary">
                        ğŸ” Scan Inbox
                    </a>
                    <a href="{{ url_for('gmail_disconnect') }}" class="action-button danger">
                        âŒ Disconnect
                    </a>
                </div>
            </div>
            {% elif config.gmail_available %}
            <div class="gmail-status disconnected">
                <p>Connect your Gmail to automatically scan your inbox for phishing emails.</p>
                <a href="{{ url_for('gmail_connect') }}" class="action-button primary">
                    ğŸ”— Connect Gmail
                </a>
            </div>
            {% else %}
            <div class="gmail-status unavailable">
                <p>âš ï¸ Gmail integration is not configured on this server.</p>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- API Keys -->
    <div class="card">
        <div class="card-header">
            <h3>ğŸ”‘ API Configuration</h3>
        </div>
        <div class="card-body">
            <form method="POST">
                <div class="form-group">
                    <label>
                        Groq API Key
                        {% if config.groq_configured %}
                        <span class="status-badge success">âœ“ Configured</span>
                        {% endif %}
                    </label>
                    <input type="password" name="groq_api_key" 
                           placeholder="Enter Groq API key" class="form-input">
                    <small><a href="https://console.groq.com" target="_blank">Get free key â†’</a></small>
                </div>
                
                <div class="form-group">
                    <label>
                        VirusTotal API Key
                        {% if config.virustotal_configured %}
                        <span class="status-badge success">âœ“ Configured</span>
                        {% endif %}
                    </label>
                    <input type="password" name="virustotal_api_key" 
                           placeholder="Enter VirusTotal API key" class="form-input">
                    <small><a href="https://www.virustotal.com" target="_blank">Get free key â†’</a></small>
                </div>
                
                <button type="submit" class="submit-button">ğŸ’¾ Save Settings</button>
            </form>
        </div>
    </div>
</div>

<style>
.gmail-status {
    padding: 20px;
    border-radius: 8px;
}

.gmail-status.connected {
    background: rgba(39, 174, 96, 0.1);
}

.gmail-status.disconnected {
    text-align: center;
    padding: 30px;
}

.gmail-status.unavailable {
    background: rgba(243, 156, 18, 0.1);
    padding: 20px;
    text-align: center;
}

.status-info {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 16px;
}

.status-icon {
    font-size: 28px;
}

.status-info p {
    color: #888;
    margin: 4px 0 0 0;
    font-size: 14px;
}

.gmail-actions {
    display: flex;
    gap: 12px;
}

.action-button.danger {
    background: #e74c3c;
}

.action-button.danger:hover {
    background: #c0392b;
}
</style>
{% endblock %}